<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <!-- 为移动设备添加 viewport -->
    <meta
      name="viewport"
      content="initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <title>绿城财富H5</title>
    <style type="text/css">
      @import url(main2.css);
    </style>
    <link rel="stylesheet" href="css/jquery.fullPage.css" />
    <link rel="stylesheet" href="css/animate.min.css" />
    <style>
      .section1 {
        background: url(https://res1.eqh5.com/Fpx7jA8F_aUMb2kFME0nvaBsN_qU?imageMogr2/auto-orient/thumbnail/331x588%3E/format/webp)
          no-repeat;
        background-size: 100% 100%;
      }
      .section2 {
        background: url(images/h5-2.jpg) no-repeat;
        background-size: 100% 100%;
      }
      .section3 {
        background: url(images/h5-3.jpg) no-repeat;
        background-size: 100% 100%;
      }
      .section4 {
        background: url(images/h5-4.jpg) no-repeat;
        background-size: 100% 100%;
      }
    </style>
  </head>
  <body>
    <div id="app" class="all">
      <div class="music">
        <div onclick="playMusic()" class="bgm-btn rotate" id="bgm-btn">
          <audio
            loop
            autoplay
            preload
            id="music"
            src="https://res1.eqh5.com/FrP-muDy6KHam1gTfTtS-2X504wp"
          ></audio>
        </div>
      </div>
      <div class="next_page" onclick="nextPage()" id="next_page">
        <div class="pre-wrap-bottom">
          <div class="pre-box1">
            <div class="pre1"></div>
          </div>
          <div class="pre-box2">
            <div class="pre2"></div>
          </div>
        </div>
      </div>
      <div class="bottom_bar">
        <span class="bar_len"></span>
        <em class="bar_progress_tip" id="bar_num">1/4</em>
      </div>
      <div id="dowebok">
        <div class="section section1">
          <div id="section1_img">
            <img
              width="100%"
              src="https://res1.eqh5.com/Fmwfa0rz6yq_4En05OMu3qpsGrNb?imageMogr2/auto-orient/thumbnail/319x173%3E/format/webp"
            />
          </div>
        </div>
        <div class="section section2">
          <div class="section2_content">
            <div class="wrapper"></div>
          </div>
        </div>
        <div class="section section3">
          <div class="section3_content">
            <div class="wrapper"></div>
          </div>
        </div>
        <div class="section section4">
          <div class="section4_content">
            <div class="section_title">
              <div class="title1">
                <span>四季辞岁</span>
              </div>
              <div class="title2">
                <span>好日常新</span>
              </div>
            </div>
            <div class="wrapper"></div>
            <div id="ring">
              <img
                width="20%"
                src="https://res1.eqh5.com/FqOH5tH5P1_UuSWCjmavn8_eYJ67?imageMogr2/auto-orient/thumbnail/174x180%3E/format/webp"
              />
            </div>
            <div id="hand">
              <img
                width="50%"
                src="https://res1.eqh5.com/FpPSl-F6tFw5f7ek-I4fVNAjL_GL?imageMogr2/auto-orient/thumbnail/198x180%3E/format/webp"
              />
            </div>
          </div>
        </div>
      </div>
    </div>
    <script src="js/vue@2.6.12.js"></script>
    <script src="js/axios.min.js"></script>
    <script src="js/jquery-1.8.3.min.js"></script>
    <script src="js/jquery.fullPage.min.js"></script>
    <script>
      // 数据绑定
      let vue = new Vue({
        el: "#app",
        data: {
          index: 1,
          section2Info: {
            year: "2021",
            month: "02",
            date: "02",
            day: "365",
            moneyNum: 9,
            total: 121212121,
            big: 222222,
            long: 1111111,
            haved: 5,
            havedMoney: 111111,
          },
        },
        methods: {},
      });
      //   音乐播放/暂停
      function playMusic() {
        var audio = document.getElementById("music");
        var rallback = document.getElementById("bgm-btn");
        if (audio !== null) {
          //检测播放是否已暂停.audio.paused 在播放器播放时返回false.
          if (audio.paused) {
            audio.play(); //audio.play();// 这个就是播放
            rallback.style.webkitAnimationPlayState = "running"; //旋转动画暂停
          } else {
            audio.pause(); // 这个就是暂停
            rallback.style.webkitAnimationPlayState = "paused";
          }
        }
      }
      //   字体大小
      function setFontSize() {
        var docEl = document.documentElement;

        var dpr, rem, scale;
        var docEl = document.documentElement;
        var fontEl = document.createElement("style");
        var metaEl = document.querySelector('meta[name="viewport"]');
        scale = 1 / dpr;
        dpr = window.devicePixelRatio || 1;
        rem = (docEl.clientWidth * dpr) / 10;

        console.log("dpr", dpr, rem);
        // 设置viewport，进行缩放，达到高清效果
        metaEl.setAttribute(
          "content",
          "width=" +
            dpr * docEl.clientWidth +
            "," +
            "initial-scale=" +
            scale +
            "," +
            "maximum-scale=" +
            scale +
            "," +
            "minimum-scale=" +
            scale +
            ",user-scalable=no"
        );
        // 设置data-dpr属性，留作的css hack之用
        docEl.setAttribute("data-dpr", dpr);
        // 动态写入样式
        docEl.firstElementChild.appendChild(fontEl);
        fontEl.innerHTML = "html{font-size:" + rem + "px!important;}";
        // 给js调用的，某一dpr下rem和px之间的转换函数
        window.rem2px = function (v) {
          v = parseFloat(v);
          return v * rem;
        };
        window.px2rem = function (v) {
          v = parseFloat(v);
          return v / rem;
        };
        window.dpr = dpr;
        window.rem = rem;
      }
      var docEl = document.documentElement;
      let dpr = window.devicePixelRatio || 1;
      if (dpr === 1) {
        docEl.style.fontSize = 12 + "px";
        $("#app").css("max-width", "320px");
        $("#app").css("margin", "0 auto");

        $(document.body)[0].style.padding = "20px !important";
        console.log("dddddd", $(document.body)[0].style.padding);
      } else {
        docEl.style.fontSize = 20 * (docEl.clientWidth / 320) + "px";
        $("#app").css("max-width", "100vw");
        $(document.body)[0].style.padding = "0";
      }
      // 下一页
      function nextPage() {
        $.fn.fullpage.moveSectionDown(); //向下滚动一页
      }
      //   下一页淡入淡出效果
      function showCss() {
        let i = 0;
        setInterval(() => {
          i = i + 2;
          $("#next_page").fadeToggle(1000);
          $("#next_page")[0].style.bottom = 10 + i + "px";
          if (i === 20) {
            i = 0;
          }
        }, 100);
      }
      function doudong() {
        $("#section1_img").addClass("animated swing");
        setTimeout(function () {
          $("#section1_img").removeClass("swing");
        }, 1000);
      }
      function showWordCss() {}
      $(function () {
        $("#bar_num")[0].innerHTML = "1/4";
        $(".bar_len")[0].style.width = "25%";
        showCss();
        doudong();
        // // 获取远端图片
        // axios({
        //   method: "get",
        //   url: "http://baidu.com",
        //   data: "",
        // }).then(function (response) {
        //   console.log("ddddddd====", response);
        //   //   response.data.pipe(fs.createWriteStream("ada_lovelace.jpg"));
        // });
        $("#dowebok").fullpage({
          afterLoad: function (link, index) {
            $("#bar_num")[0].innerHTML = index + "/4";
            $(".bar_len")[0].style.width = 25 * index + "%";
            vue.$data.index = index;
            if (index === 1) {
              doudong();
              deletWrapperNode(0);
              deletWrapperNode(1);
              deletWrapperNode(2);
            }
            // 第二页
            if (index === 2) {
              deletWrapperNode(1);
              deletWrapperNode(2);
              let section2Info = vue.$data.section2Info;
              let data = [
                "时光飞逝，新年又至",
                "绿城财富陪您",
                "做时间的朋友",
                "又走过一轮四季",
                `${section2Info.year}年${section2Info.month}月${section2Info.date}日`,
                `在过去的${section2Info.day}天里`,
                `您一共进行了${section2Info.moneyNum}笔交易`,
                `累计投资了${section2Info.total}万元`,
                `最大的一笔投资为${section2Info.big}万元`,
                `最长的一笔投资为${section2Info.long}天`,
                `目前存续${section2Info.haved}个产品`,
                `存续产品为${section2Info.havedMoney}万元`,
              ];
              setTimeout(() => {
                addWrapperNode(index - 2, data);
              }, 100);
            }
            // 第三页
            if (index === 3) {
              deletWrapperNode(2);
              deletWrapperNode(0);
              let data = [
                "回首2020",
                "不平凡的一年",
                "让我们体会到了国家的重要性",
                "疫情肆虐的一年",
                "让我们体会到了健康的重要性",
                "互联网金融整顿和基金暴涨冰火两重天的一年",
                "让我们体会到了保守、长期、资产配置的重要性",
              ];
              setTimeout(() => {
                addWrapperNode(index - 2, data);
              }, 100);
            }
            // 第四页
            if (index === 4) {
              deletWrapperNode(1);
              deletWrapperNode(0);
              let data = [
                "保持合理的资产配置",
                "关注低估值板块回归的配置机会",
                "做时间的朋友",
                "用我们的专业成就您的价值",
                "我们相信",
                "唯有专业、审慎和长期经营",
                "方能博取未来",
                "我们愿与所有并肩奋斗的亲密伙伴一起",
                "开启崭新的、充满期待的2021年",
                "如需了解绿城财富新一年资产配置建议",
                "请点击2020年度投资报告或咨询您的专属财富顾问",
              ];
              setTimeout(() => {
                addWrapperNode(index - 2, data);
                setTimeout(() => {
                  $("#hand").css("opacity", 1);
                  $("#ring").css("opacity", 1);
                  $("#hand>img").addClass("animated bounceIn");
                  setTimeout(() => {
                    $("#ring>img").addClass("animated bounceIn");
                  }, 1200);
                }, 14000);
              }, 100);
            } else {
              $("#hand").css("opacity", 0);
              $("#ring").css("opacity", 0);
              $("#ring").removeClass("bounceIn");
              $("#hand").removeClass("bounceIn");
            }
          },
        });
        addWrapperNode = function (n, data) {
          let wrapper = document.getElementsByClassName("wrapper")[n];
          let delayCol = 0;
          for (let i = 0; i < data.length; i++) {
            let str = data[i];
            let op = document.createElement("p");
            for (let j = 0; j < str.length; j++) {
              let ospan = document.createElement("span");
              ospan.innerText = str[j];
              ospan.style.opacity = 0;
              op.appendChild(ospan);
              ospan.style.transitionDelay = delayCol + 0.1 * j + "s";
              ospan.style.transitionDuration = 10 + "ms";
              (function (ospan) {
                setTimeout(function () {
                  ospan.style.opacity = 1;
                }, 10);
              })(ospan);
            }
            delayCol += str.length * 0.1;
            wrapper.appendChild(op);
          }
        };
        deletWrapperNode = function (n) {
          let wrapper = document.getElementsByClassName("wrapper")[n];
          let childs = wrapper.childNodes;
          for (let i = childs.length - 1; i >= 0; i--) {
            wrapper.removeChild(childs[i]);
          }
        };
      });
    </script>
  </body>
</html>
